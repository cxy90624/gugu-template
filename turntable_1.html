<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0"/>
	<title>大转盘</title>
	<link rel="stylesheet" href="css/theme1.css">
	<link rel="stylesheet" href="css/turntable.css">
	<script type="text/javascript" src="js/jquery-1.8.0.min.js"></script>
	<script type="text/javascript" src="js/layer/layer.js"></script>
	<script type="text/javascript" src="js/alertJs.js"></script>
</head>
<body>
	<div class="ex_container">
		<div class="tpage">
			<!-- title -->
			<header id="header" class="header color1">
	            <div class="backicon"></div>
	            <span>优惠详情</span>
	            <div class="wmhome"></div>
	        </header>
	        <!-- 大转盘 -->
	        <div class="turntable">
	        	<div class="turn-title">超级大转盘</div>
	        	<div class="turntable-all">
	        		<!-- 转盘 -->
		        	<div class="turntable-div" id="turntable">
		        		<!-- 大转盘2，就zp1改为zp2，模板3就改为zp3 -->
						<canvas class="rotatePan zp1" id="rotatePan" width="280px" height="280px"></canvas>
						<!-- 大转盘2，就zz1改为zz2，模板3就改为zz3 -->
						<div class="beginRotate zz1" id="beginRotate"></div>
						<!-- 抽奖机会已经用完，如果活动过期增加rotateOverdue -->
						<div class="rotateDone rotateOverdue none"></div>
					</div>
		        	<!-- 云朵背景 -->
		        	<div class="tcloud"></div>
	        	</div>
	        	
	        	<!-- 抽奖机会 -->
	        	<div class="tword">还有&nbsp;<span>2</span>&nbsp;次抽奖机会</div>
	        	<!-- table -->
	        	<table class="prizeInfo">
					<tbody>
						<tr> 
							<th style="width: 30%;">奖项</th>
							<th style="width: 30%;">数量</th>
							<th style="width: 40%;">奖品</th>
						</tr>
						<tr>
							<td style="width: 30%;">一等奖</td>
							<td style="width: 30%;">1</td>
							<td style="width: 40%;">女神</td>
						</tr>
						<tr>
							<td style="width: 30%;">二等奖</td>
							<td style="width: 30%;">200</td>
							<td style="width: 40%;">软妹子</td>
						</tr>
						<tr>
							<td style="width: 30%;">三等奖</td>
							<td style="width: 30%;">5000</td>
							<td style="width: 40%;">女汉子</td>
						</tr>
					</tbody>
				</table>
				<!-- 中奖名单 -->
				<div>
					<img class="tangle" src="image/common/angle.png">
					<section class="peopleList">
						<div class="t_center">中奖名单</div>
						<marquee behavior="scroll" direction="up" class="scrollList" scrollamount="2" style="height: 60px;">
							<table>
								<tbody>
									<tr>
										<td>153****5010</td>
										<td>三等奖</td>
										<td>2015-07-02</td>
									</tr>
									<tr>
										<td>153****5010</td>
										<td>三等奖</td>
										<td>2015-07-02</td>
									</tr>
									<tr>
										<td>153****5010</td>
										<td>三等奖</td>
										<td>2015-07-02</td>
									</tr>
									<tr>
										<td>153****5010</td>
										<td>三等奖</td>
										<td>2015-07-02</td>
									</tr>
								</tbody>
							</table>
						</marquee>
					</section>
				</div>
				<p class="tdate">
					-有效期为：
					<br> 2015-07-02&nbsp;至&nbsp;2015-09-30
				</p>
				<p class="tdate">
					-兑奖规则：
					<br>
				</p>
				<pre class="beak-word">
					1、刮开涂层（转动大转盘） 即可知晓获奖结果
					2、获得的优惠券，请在优惠券有效期内到店使用
					3、最终解释权归本店所有，具体情况详询商家                    
				</pre>
				<img style="width: 100%;" src="image/common/tree.png">
	        </div>
	        <!-- cont -->
	        <article class="pd2">
	        	<div class="couponD_inner">
	        		<div class="couponD-pic">
                    	<img src="image/common/wapDFImage.png" />
                    	<div class="tpd1">
							<pre class="new_d_content w_pre">转转盘赢女神</pre>
						</div>
                    </div>
	        	</div>
	        	<!-- 公司简介 -->
	        	<div class="couponD_inner-company mt10">
	        		<div class="header2">
                        <span class="small-title">公司简介</span>
                        <div class="ic_right"></div>
                    </div>
                    <div class="couponD_link">                            
						<p>这是公司简介这是公司简介这是公司简介这是公司简介这是公司简介这是公司简介</p>
                    </div>
	        	</div>
	        	<!-- 联系方式 -->
	        	<div class="couponD_inner-link mt10">
	        		<div class="header2">
                        <span class="small-title">联系方式</span>
                        <div class="ic_right"></div>
                    </div>
                    <div class="couponD_link">                            
						<p>联系电话：987545789
							<span class="phone-wrapper">
		                    <img class="img-wrapper" src="image/theme1/phone.png"></span></p>
                        <p>地　　址：成华区欣然二街</p>
                    </div>
	        	</div>
	        </article>
	        <div class="turnfooter">由北京青牛风科技有限公司©提供技术支持</div>
		</div>
	</div>
	<script type="text/javascript">
		function initPosition() {
			var viewportWidth = window.innerWidth;
			var viewportHeight = window.innerHeight;
			var rotateButton = document.getElementById("beginRotate");
			var rotatePan = document.getElementById("rotatePan");
			var turntable = document.getElementById("turntable");
			turntable.style.left = (viewportWidth - $("#turntable").width()) / 2+ "px";
			rotateButton.style.left = ($("#turntable").width() - $("#beginRotate").width())/ 2 + "px";
		}
		$(function(){
			initPosition();
		})
		function initData(){
		 var ctx = document.getElementById('rotatePan').getContext("2d");
		    ctx.translate($("#rotatePan").width()/2,$("#rotatePan").height()/2);
		    ctx.fillStyle="red";
		    ctx.beginPath();
		    ctx.closePath();
		    ctx.fill();  
		    var sequence='1等奖,2等奖,3等奖,4等奖,5等奖,6等奖';
		    
		   	var prizes=sequence.split(",");
		    var angelNum=prizes.length;
		    
		    for (var i=0;i<angelNum;i++)
		    {
		        ctx.save();
		        ctx.rotate(Math.PI*(-1/2+2*i/angelNum+1/(angelNum)));
		        drawFont(ctx,prizes[i]);
		        ctx.restore();
		    }
		
		}
		function drawFont(ctx,txt){
		    ctx.save(); 
		    ctx.translate(100,0);
		    ctx.rotate(Math.PI*(1/2));
		    ctx.fillStyle='#CECEF';
		    ctx.font="bold 16px 微软雅黑"; 
		    for(var i=0;i<txt.length;i++){
		     	var content=txt.substring(i,i+1);
		     	ctx.fillText(content, -ctx.measureText(content).width/2, i*17);
		     }
		    ctx.restore(); 
			ctx.textBaseline='middle';
		}

		window.onload = function() {
			initData();
		}
		var play=true;
		function roate() {
			if(!play){
				return;
			}else{
				var angle = "rotate(1500deg)";
				$("#rotatePan").addClass("pan_roate");
				$("#rotatePan").css({
					"-webkit-transform" : angle,
					"-o-transfrom" : angle,
					"-moz-transform" : angle
				});
				
				play=false;
				setTimeout(function() {
					/*showPrizeMessageBox();*/
					$("#rotatePan").removeClass("pan_roate");

				}, 6100);
			}
			
			
			/*$.ajax({  
	            url :"<%=request.getContextPath()%>/${domainHacks}/11/11/getTurnTableLottery",
				type : "post",
				async : true,
				dataType : "json",
				error : function() {
					
				},
				success : function(json) {

					if (json.returnCode == "-11") {
						alert("抽奖次数已用完");
						return;
					}
					if (json.returnCode != "0") {
						alert("抽奖异常");
					} else {
						
						var angle = "rotate(" + json.angle + "deg)";
						$("#rotatePan").addClass("pan_roate");
						$("#rotatePan").css({
							"-webkit-transform" : angle,
							"-o-transfrom" : angle,
							"-moz-transform" : angle
						});
						endLottery(json.prizeLevel, json.prizeName);
						play=false;
						setTimeout(function() {
							showPrizeMessageBox();
							$("#rotatePan").removeClass("pan_roate");

						}, 6100);
					}
				}
			}); */
		}
		$(".beginRotate").click(function(){
			roate();
		})
	</script>
</body>
</html>
